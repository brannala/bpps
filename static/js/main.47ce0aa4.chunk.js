(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,a){},21:function(e,t,a){},23:function(e,t,a){},28:function(e,t,a){e.exports=a(40)},39:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(17),l=a.n(s),i=a(3),c=a(4),o=a(6),u=a(5),p=a(7),m=a(2),h=a(42),d=a(43),f=a(27),v=(a(21),function(e){function t(e){return Object(i.a)(this,t),Object(o.a)(this,Object(u.a)(t).call(this,e))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"seqview2"},r.a.createElement("textarea",{readOnly:!0,wrap:"off",className:"seq-box",value:this.props.locusText}))}}]),t}(n.Component)),b=a(18),q=a.n(b),y=a(25),S=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).uploadFile=function(){var e=Object(y.a)(q.a.mark(function e(n){var r,s,l;return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.persist(),n.target&&n.target.files){e.next=3;break}return e.abrupt("return");case 3:return a.setState({waitingForFileUpload:!0}),r=n.target.files,s=r.item(r.length-1),e.prev=6,e.next=9,t.readUploadedFileAsText(s);case 9:l=e.sent,a.setState({uploadedFileContents:l,waitingForFileUpload:!1}),a.props.readFile(l,r[0].name),"sequence"===a.props.fileType&&a.props.initPosInLocusArray(),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(6),console.log(e.t0),a.setState({waitingForFileUpload:!1});case 19:case"end":return e.stop()}},e,null,[[6,15]])}));return function(t){return e.apply(this,arguments)}}(),a.state={uploadedFileContents:null,waitingForFileUpload:!1},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"read-seqs"},r.a.createElement("input",{accept:".txt",multiple:!0,onChange:function(t){return e.uploadFile(t)},type:"file"}))}}]),t}(r.a.Component);S.readUploadedFileAsText=function(e){var t=new FileReader;return new Promise(function(a,n){t.onerror=function(){t.abort(),n(new DOMException("Problem parsing input file."))},t.onload=function(){a(t.result)},t.readAsText(e)})};var E=S,g=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={posInLocusArray:0},a.initPosInLocusArray=a.initPosInLocusArray.bind(Object(m.a)(Object(m.a)(a))),a.handleScanClickUp=a.handleScanClickUp.bind(Object(m.a)(Object(m.a)(a))),a.handleScanClickDown=a.handleScanClickDown.bind(Object(m.a)(Object(m.a)(a))),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"initPosInLocusArray",value:function(){this.setState(function(){return{posInLocusArray:0}})}},{key:"handleScanClickUp",value:function(e){var t=this;this.state.posInLocusArray<this.props.locusArray.length-1&&this.setState(function(){return{posInLocusArray:t.state.posInLocusArray+1}})}},{key:"handleScanClickDown",value:function(e){this.state.posInLocusArray>0&&this.setState({posInLocusArray:this.state.posInLocusArray-1})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"seqview"},r.a.createElement("h2",null,"Step 1:"),r.a.createElement("p",null,"Upload a file containing DNA sequences in bpp format."),r.a.createElement(E,{readFile:this.props.readFile,initPosInLocusArray:this.initPosInLocusArray,fileType:"sequence"}),r.a.createElement(v,{locusText:this.props.locusArray[this.state.posInLocusArray]}),r.a.createElement("div",null,r.a.createElement("button",{onClick:this.handleScanClickDown}," - "),r.a.createElement("button",{onClick:this.handleScanClickUp}," + "),r.a.createElement("span",{className:"counts"},"Locus: ",this.props.locusArray.length>0?this.state.posInLocusArray+1:" 0 "," / ",this.props.locusArray.length),r.a.createElement("span",{className:"counts"},"NoSeqs: ",void 0!==this.props.locusCounts&&0!==this.props.locusCounts.length?this.props.locusCounts[this.state.posInLocusArray].noseqs:" 0 "),r.a.createElement("span",{className:"counts"}," NoSites: ",void 0!==this.props.locusCounts&&0!==this.props.locusCounts.length?this.props.locusCounts[this.state.posInLocusArray].nosites:" 0 "))),r.a.createElement("div",{className:"quick-start"},r.a.createElement("p",null,"Quick start: Choose a file with aligned sequences at one or more loci in bpp format (non-interleaved). The bpp format is a text file with a series of one or more loci arranged sequentially. a description of the bpp sequence data file format (and example) are found here.  Once the data are successfully uploaded continue to step 2 (create map file).")))}}]),t}(n.Component),O=a(13);function F(e){if(e.length>0){var t=[];for(var a in e)for(var n in e[a].sequences)t.push(e[a].sequences[n].seqname);return Object(O.a)(new Set(t))}return[]}var x=a(11),j=(a(14),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).getMatchedAsString=a.getMatchedAsString.bind(Object(m.a)(Object(m.a)(a))),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getMatchedAsString",value:function(){var e="";if(this.props.seqMatches.matchedSeqs.length>0)for(var t=0;t<this.props.seqMatches.matchedSeqs.length;t++)for(var a=0;a<this.props.seqMatches.matchedSeqs[t].seqNames.length;a++)e+=this.props.seqMatches.matchedSeqs[t].seqNames[a]+" = "+this.props.seqMatches.matchedSeqs[t].spName+"\n";return e.trim()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"title"},r.a.createElement("p",null,"Sequence name =  species name ")),r.a.createElement("div",{className:"col3"},r.a.createElement("textarea",{className:"text-mapped",value:this.getMatchedAsString()})))}}]),t}(n.Component)),N=function(e){function t(e){return Object(i.a)(this,t),Object(o.a)(this,Object(u.a)(t).call(this,e))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getUnmatchedAsString",value:function(e){var t="";if(e.length>0)for(var a in e)t+=e[a]+"\n";return t.trim()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"title"},r.a.createElement("p",null,"Sequences names")),r.a.createElement("div",{className:"col2"},r.a.createElement("textarea",{className:"text-unmapped",value:this.getUnmatchedAsString(this.props.seqMatches.unmatchedSeqs)})))}}]),t}(n.Component),k=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).createFilters=a.createFilters.bind(Object(m.a)(Object(m.a)(a))),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"createFilters",value:function(e){return r.a.createElement("dl",{key:e.key},e.text)}},{key:"render",value:function(){var e=this.props.filters.map(this.createFilters);return r.a.createElement("div",null,r.a.createElement("div",{className:"map-box"},r.a.createElement("ul",null,e)))}}]),t}(n.Component),w=a(16);function C(e){e.mapDone;if(e.mapDone){var t=e.seqFileName.substr(0,e.seqFileName.indexOf("."));""===t?t=e.seqFileName+"map.txt":t+="map.txt";var a=function(e){var t="",a=new RegExp(".*^.+"),n=[];try{if(e.matchedSeqs.length>0){for(var r in e.matchedSeqs)for(var s in e.matchedSeqs[r].seqNames)if(null===e.matchedSeqs[r].seqNames[s].match(a))throw new Error("sequence labels must be of format IDName^SpecimenName. Sequence name was missing ^ !");for(var l in e.matchedSeqs){var i=[];for(var c in e.matchedSeqs[l].seqNames)i.push(e.matchedSeqs[l].seqNames[c].substr(e.matchedSeqs[l].seqNames[c].indexOf("^")+1));i=Object(O.a)(new Set(i)),n.push({specimen:i,spName:e.matchedSeqs[l].spName})}for(var o in console.log(n[0].specimen[2]),n)for(var u in n[o].specimen)t+=n[o].specimen[u]+"  "+n[o].spName+"\n";console.log(t)}}catch(p){alert(p)}return t}(e.seqMatches),n=new Blob([a],{type:"text/plain;charset=utf-8"});return r.a.createElement("div",{className:"downloadFile"},r.a.createElement("label",null,"Map file is ready for download: "),r.a.createElement("button",{className:"downButton",onClick:function(e){w.saveAs(n,t)}},"Download"))}return r.a.createElement("div",{className:"downloadFile"},r.a.createElement("p",null,"Sequence names must be completely filtered before map file can be downloaded."))}var D=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={seqMatches:{matchedSeqs:[],unmatchedSeqs:F(a.props.sequenceData)},uniqSeqs:F(a.props.sequenceData),regExp_SpName:[],filters:[],mapDone:!1},a.addFilter=a.addFilter.bind(Object(m.a)(Object(m.a)(a))),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"addFilter",value:function(e){var t,a=this.state.regExp_SpName,n=this.state.seqMatches,r=this.state.filters,s=[];for(var l in this.state.uniqSeqs)s.push(this.state.uniqSeqs[l]);if(""!==this._spNameInput.value&&""!==this._regExpInput.value){r.unshift({text:this._spNameInput.value+" + "+this._regExpInput.value,key:Date.now()});try{t=new RegExp(this._regExpInput.value),a.push({reg_exp:t,spName:this._spNameInput.value}),n=function(e,t){var a=[],n=e,r=function(e){var r=n.filter(function(a){return a.match(t[e].reg_exp)});for(var s in r){var l=n.indexOf(r[s]);l>-1&&n.splice(l,1)}a.push({seqNames:r,reg_exp:t[e].reg_exp,spName:t[e].spName})};for(var s in t)r(s);return{matchedSeqs:a,unmatchedSeqs:n}}(s,a),this.setState({filters:r}),this.setState({regExp_SpNames:a}),this.setState({seqMatches:n}),e.preventDefault()}catch(e){alert("warning! invalid regular expression syntax: ".concat(this._regExpInput.value))}n.matchedSeqs.length>0&&0===n.unmatchedSeqs.length&&this.setState({mapDone:!0})}this._spNameInput.value="",this._regExpInput.value=""}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"mapfile-box"},r.a.createElement("h2",null,"Step 2:"),r.a.createElement("p",null,"Create a map file in bpp format. Use regular expressions to associate sequence names with species names."),r.a.createElement(x.Columns,{gutters:!0,stackMaxWidth:700},r.a.createElement(x.Column,{size:10},r.a.createElement(N,{seqMatches:this.state.seqMatches})),r.a.createElement(x.Column,{size:21},r.a.createElement("div",{className:"title"},r.a.createElement("p",null,"Enter species name + regular expression")),r.a.createElement("div",{className:"col1"},r.a.createElement("form",{onSubmit:this.addFilter},r.a.createElement("input",{placeholder:"species name",ref:function(t){return e._spNameInput=t}}),"  +  ",r.a.createElement("input",{placeholder:"regular expression",ref:function(t){return e._regExpInput=t}}),r.a.createElement("button",{type:"submit",className:"smallButton"},"add"))),r.a.createElement(k,{filters:this.state.filters})),r.a.createElement(x.Column,{siz:20},r.a.createElement(j,{seqMatches:this.state.seqMatches})))),r.a.createElement("div",null,r.a.createElement(C,{mapDone:this.state.mapDone,seqMatches:this.state.seqMatches,seqFileName:this.props.seqFileName})),r.a.createElement("div",{className:"quick-start"},r.a.createElement("p",null,'Quick start: Enter species name in left box (e.g., Homo_sapiens) and a regular expression (RegExp) in right box to filter sequences. For example, /.*(Hsap).*/ finds sequence labels containing the substring "Hsap" (e.g., ^Hsap12 or MyHsapiens) but ignores a label such as H.sap. An online RegExp tester is found ',r.a.createElement("a",{href:"https://regexr.com"},"here"),".")))}}]),t}(n.Component);function I(e){var t,a=[];for(t in e)a.push(A(t,e));return a}function M(e){var t=[];for(var a in e)t.push({noseqs:e[a].noseqs,nosites:e[a].nosites});return t}function A(e,t){var a={noseqs:t[e].noseqs,nosites:t[e].nosites,sequences:[]};for(var n in t[e].sequences)a.sequences.push({seq:t[e].sequences[n].seq,seqname:t[e].sequences[n].seqname});for(var r=a.sequences.sort(function(e,t){return t.seqname.length-e.seqname.length})[0].seqname,s=function(e,t){for(var a=t,n=e.length-t.length,r=1;r<=n;r++)a+=" ";return a},l="",i=0;i<t[e].sequences.length;i++)l+=s(r,t[e].sequences[i].seqname)+"  "+t[e].sequences[i].seq,i!==t[e].sequences.length-1&&(l+="\n");return l}var T=function(e){var t,a,n=[],r=0,s=function(e){return{sequenceData:[],error:"error: unexpected input: ".concat(e)}};for(a=e.trim();a.length>0;){if(null!==(t=a.split(/\s+/,2))[0].match(/[^\d]+/)||null!==t[1].match(/[^\d]+/))return s("missing number of sequences (or sites) at locus ".concat(r+1));a=a.replace(/\d+\s+\d+/,"").trim(),n.push({noseqs:t[0],nosites:t[1],sequences:[]});for(var l=0;l<Number(t[0]);l++){var i=void 0,c=void 0;if(null===(i=a.split(/\s+/,1))[0]||null===i[0].match(/[^\/d+].*/))return s("unexpected input at locus ".concat(r+1," near ").concat(i));if(null===(c=(a=a.replace(/[^\d][^\s]+/,"").trim()).split(/\n|\r/,1))[0])return s("missing sequence at locus ".concat(r+1));if(c[0]=c[0].replace(/\s/g,""),null!==c[0].match(/[\d]+/))return s("sequence ".concat(l+1," at locus ").concat(r+1," contains a number!"));n[r].sequences.push({seqname:i[0],seq:c[0]}),a=null===a.match(/(\n|\r)+/)?a.replace(/.*/,""):a.replace(/.*(\n|\r)/,"").trim()}r++}var o=function(e){var t=!0,a=!1,n=void 0;try{for(var r,s=e[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var l=r.value,i=!0,c=!1,o=void 0;try{for(var u,p=l.sequences[Symbol.iterator]();!(i=(u=p.next()).done);i=!0){var m=u.value;if(Number(l.nosites)!==m.seq.length)return{error:!0,error_message:"expected ".concat(l.nosites," sites in sequence ").concat(m.seqname," but observed ").concat(m.seq.length," sites")}}}catch(h){c=!0,o=h}finally{try{i||null==p.return||p.return()}finally{if(c)throw o}}}}catch(h){a=!0,n=h}finally{try{t||null==s.return||s.return()}finally{if(a)throw n}}return{error:!1}}(n);return o.error?s(o.error_message):{sequenceData:n,error:null}},L=a(12);a(23);function _(e){return e.sequenceData.length>0?r.a.createElement("div",{style:{padding:20}},r.a.createElement("p",null,"Upload a map file to continue"),r.a.createElement(E,{readFile:e.readFile,fileType:"map"})):r.a.createElement("p",null,"Go to step 1 and upload sequence data to begin.")}function B(e){var t=new Map;try{var a=e.trim().split("\n");if(!(a.length>0))throw new Error("Empty map file!");var n=!0,r=!1,s=void 0;try{for(var l,i=a[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var c=l.value.trim().split(/\s+/g);if(2!==c.length)throw new Error("map file syntax error at: ".concat(c[0]));t.set(c[0],c[1])}}catch(o){r=!0,s=o}finally{try{n||null==i.return||i.return()}finally{if(r)throw s}}return t}catch(o){return alert("Error: ".concat(o.message)),[]}}function U(e){var t=Object(O.a)(e.values());return Object(O.a)(new Set(t))}function P(e,t,a){return a.get(e)===t}function R(e,t,a){var n=0,r=!0,s=!1,l=void 0;try{for(var i,c=t[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var o=i.value,u=0,p=!0,m=!1,h=void 0;try{for(var d,f=o.sequences[Symbol.iterator]();!(p=(d=f.next()).done);p=!0){P(z(d.value.seqname),e,a)&&u++}}catch(v){m=!0,h=v}finally{try{p||null==f.return||f.return()}finally{if(m)throw h}}u>n&&(n=u)}}catch(v){s=!0,l=v}finally{try{r||null==c.return||c.return()}finally{if(s)throw l}}return n}function z(e){return e.substr(e.indexOf("^")+1)}function H(e,t,a){var n=[],r=!0,s=!1,l=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){i.value;n.push([])}}catch(C){s=!0,l=C}finally{try{r||null==c.return||c.return()}finally{if(s)throw l}}var o=0,u=!0,p=!1,m=void 0;try{for(var h,d=e[Symbol.iterator]();!(u=(h=d.next()).done);u=!0){var f=h.value,v=!0,b=!1,q=void 0;try{for(var y,S=t[Symbol.iterator]();!(v=(y=S.next()).done);v=!0){var E=y.value,g=[],O=!0,F=!0,x=!1,j=void 0;try{for(var N,k=f.sequences[Symbol.iterator]();!(F=(N=k.next()).done);F=!0){var w=N.value;P(z(w.seqname),E,a)&&(g.push(w.seq),O=!1)}}catch(C){x=!0,j=C}finally{try{F||null==k.return||k.return()}finally{if(x)throw j}}O||n[o].push(g)}}catch(C){b=!0,q=C}finally{try{v||null==S.return||S.return()}finally{if(b)throw q}}o++}}catch(C){p=!0,m=C}finally{try{u||null==d.return||d.return()}finally{if(p)throw m}}return n}function Q(e,t){var a=0;for(var n in e)a+=W(e[n],t[n]);return a/e.length}function W(e,t){var a=new Set;return a.add("-"),a.add("?"),e==t||a.has(e)||a.has(t)?0:1}function J(e){var t=0;if(e.length<=1)return 0;for(var a=0;a<e.length-1;a++)for(var n=a+1;n<e.length;n++)t+=Q(e[a],e[n]);return 2*t/(e.length*(e.length-1))}function G(e){var t=0,a=0,n=!0,r=!1,s=void 0;try{for(var l,i=e[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var c=l.value;a+=c.length;var o=!0,u=!1,p=void 0;try{for(var m,h=c[Symbol.iterator]();!(o=(m=h.next()).done);o=!0){t+=J(m.value)}}catch(d){u=!0,p=d}finally{try{o||null==h.return||h.return()}finally{if(u)throw p}}}}catch(d){r=!0,s=d}finally{try{n||null==i.return||i.return()}finally{if(r)throw s}}return{priorTheta:{a:3,b:2*(t/=a)},priorTau:{a:3,b:2*function(e){var t=0,a=[],n=!0,r=!1,s=void 0;try{for(var l,i=e[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var c=l.value,o=[],u=!0,p=!1,m=void 0;try{for(var h,f=c[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var v=h.value;o=o.concat(v)}}catch(d){p=!0,m=d}finally{try{u||null==f.return||f.return()}finally{if(p)throw m}}a.push(o)}}catch(d){r=!0,s=d}finally{try{n||null==i.return||i.return()}finally{if(r)throw s}}for(var b=0;b<a.length;b++)for(var q=a[b],y=0;y<q.length-1;y++)for(var S=y;S<q.length;S++)Q(q[y],q[S])>t&&(t=Q(q[y],q[S]));return t}(e)}}}var K=a(16);var V=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="";if(this.props.mapData.size>0){var t=this.props.seqFileName.substr(0,this.props.seqFileName.indexOf("."));e=""===t?this.props.seqFileName+".ctl":t+".ctl";var a=function(e,t,a,n,r,s,l,i,c){var o="",u=n.length;for(var p in o+="    seed = -1 \n",o+="    seqfile = ".concat(e," \n"),o+="    Imapfile = ".concat(t," \n"),o+="    outfile = out.txt \n    mcmcfile = mcmc.txt \n\n",o+="    speciesdelimitation = ".concat(Number(s.speciesDelim)," \n"),o+="    speciestree = ".concat(Number(s.speciesTreeInf)," \n"),o+="    species&tree = ".concat(r.length,"  "),r)o+="".concat(r[p],"  ");for(var m in o+="\n                      ",o+=l,o+="\n",o+="                    ".concat(i,"; \n"),o+="    diploid = ",r)o+=" ".concat(Number(s.diploid));return o+="\n",o+="    cleandata = 0\n",o+="    usedata = 1\n",o+="    nloci = ".concat(u,"  \n"),o+="    thetaprior = ".concat(c.priorTheta.a,"  ").concat(c.priorTheta.b.toPrecision(2)," \n"),o+="    tauprior = ".concat(c.priorTau.a,"  ").concat(c.priorTau.b.toPrecision(2)," \n"),o+="    finetune = 1: 0.02 0.02 0.02 0.02 0.02 0.02 0.02 \n",o+="    print = 1 0 0 \n",o+="    burnin = ".concat(s.burnin," \n"),o+="    sampfreq = ".concat(s.sampleFreq," \n"),o+="    nsample = ".concat(s.mcmcSamples," \n")}(this.props.seqFileName,this.props.mapFileName,this.props.mapData,this.props.sequenceData,this.props.speciesList,this.props.ctrlFileOpts,this.props.numberSeqs,this.props.nTree,this.props.priors),n=new Blob([a],{type:"text/plain;charset=utf-8"});return r.a.createElement("div",{className:"downloadFile"},r.a.createElement("textarea",{className:"ctrlFileBox",readOnly:!0,wrap:"off",value:a}),r.a.createElement("div",{downLoadButton:!0},r.a.createElement("label",null,"Control file is ready for download: "),r.a.createElement("button",{className:"downButton",onClick:function(t){K.saveAs(n,e)}},"Download")))}return null}}]),t}(n.Component),X=function(e){function t(e){return Object(i.a)(this,t),Object(o.a)(this,Object(u.a)(t).call(this,e))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=function(e){return r.a.createElement("input",Object.assign({type:"checkbox"},e))};return this.props.mapData.size>0?r.a.createElement("div",{className:"options-box"},r.a.createElement("p",null,"Control File Options"),r.a.createElement("ul",null,r.a.createElement("form",null,r.a.createElement("li",null,r.a.createElement("label",null,r.a.createElement(e,{checked:this.props.ctrlFileOpts.speciesDelim,onChange:this.props.handleSpecDelimCheckbox}),r.a.createElement("span",null,"Species Delimitation"))),r.a.createElement("li",null,r.a.createElement("label",null,r.a.createElement(e,{checked:this.props.ctrlFileOpts.speciesTreeInf,onChange:this.props.handleSpecTreeInfCheckbox}),r.a.createElement("span",null,"Species Tree Inferred"))),r.a.createElement("li",null,r.a.createElement("label",null,r.a.createElement(e,{checked:this.props.ctrlFileOpts.diploid,onChange:this.props.handleDiploidCheckbox}),r.a.createElement("span",null,"Diploid Sequence Data"))),r.a.createElement("li",null,r.a.createElement("label",null,r.a.createElement("span",null,"Burnin"),r.a.createElement("input",{onChange:this.props.handleBurninSet,name:"burnin",type:"number",min:"1",value:this.props.ctrlFileOpts.burnin,className:"burninField"}))),r.a.createElement("li",null,r.a.createElement("label",null,r.a.createElement("span",null,"Sampling Frequency"),r.a.createElement("input",{onChange:this.props.handleSampleFreqSet,name:"sfreq",type:"number",min:"1",value:this.props.ctrlFileOpts.sampleFreq,className:"sFreqField"}))),r.a.createElement("li",null,r.a.createElement("label",null,r.a.createElement("span",null,"MCMC Samples"),r.a.createElement("input",{onChange:this.props.handleMcmcSamples,name:"mcmc",type:"number",min:"1",value:this.props.ctrlFileOpts.mcmcSamples,className:"mcmcField"})))))):null}}]),t}(n.Component);function Y(e){var t={newick:""};return function e(t,a){if(null!=t){var n=t;null!=n.left&&(a.newick+="(",e(n.left,a)),null!=n.right&&(a.newick+=", ",e(n.right,a),a.newick+=")"),null==n.left&&null==n.right&&(a.newick+=n.name)}}(e,t),t.newick}function Z(e,t,a,n){this.name=e,this.left=t,this.right=a,this.father=n}function $(e,t){if(null!=e){var a=e;null!=a.left&&$(a.left,t),null!=a.right&&$(a.right,t),null==a.left&&null==a.right&&t.push(a)}}a(16);var ee=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={mapData:[],mapFileName:"",ctrlFileOpts:{speciesDelim:!1,speciesTreeInf:!0,diploid:!1,burnin:2e3,sampleFreq:2,mcmcSamples:2e4},nTree:"",seqBySpecies:[],priors:{priorTheta:{a:3,b:.002},priorTau:{a:3,b:.002}},numberSeqs:[],speciesList:[]},a.handleMapFileRead=a.handleMapFileRead.bind(Object(m.a)(Object(m.a)(a))),a.handleSpecDelimCheckbox=a.handleSpecDelimCheckbox.bind(Object(m.a)(Object(m.a)(a))),a.handleSpecTreeInfCheckbox=a.handleSpecTreeInfCheckbox.bind(Object(m.a)(Object(m.a)(a))),a.handleDiploidCheckbox=a.handleDiploidCheckbox.bind(Object(m.a)(Object(m.a)(a))),a.handleBurninSet=a.handleBurninSet.bind(Object(m.a)(Object(m.a)(a))),a.handleSampleFreqSet=a.handleSampleFreqSet.bind(Object(m.a)(Object(m.a)(a))),a.handleMcmcSamples=a.handleMcmcSamples.bind(Object(m.a)(Object(m.a)(a))),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleMapFileRead",value:function(e,t){console.log(B(e)),this.setState({mapData:B(e)}),this.setState({mapFileName:t}),this.setState({speciesList:U(this.state.mapData)});var a=Y(function(e){var t=[],a=new Z("root",null,null,null);for(a.left=new Z("empty",null,null,a),a.right=new Z("empty",null,null,a),$(a,t);t.length<e.length;){var n=Math.floor(Math.random()*t.length);t[n].left=new Z("empty",null,null,t[n]),t[n].right=new Z("empty",null,null,t[n]),$(a,t=[])}for(var r=0;r<t.length;r++)t[r].name=e[r];return a}(this.state.speciesList));this.setState({nTree:a}),this.setState({seqBySpecies:H(this.props.sequenceData,this.state.speciesList,this.state.mapData)}),this.setState({priors:G(this.state.seqBySpecies)});var n="";for(var r in this.state.speciesList)n+="".concat(R(this.state.speciesList[r],this.props.sequenceData,this.state.mapData),"  ");this.setState({numberSeqs:n})}},{key:"handleSpecDelimCheckbox",value:function(e){var t=Object(L.a)({},this.state.ctrlFileOpts);this.state.ctrlFileOpts.speciesDelim?t.speciesDelim=!1:t.speciesDelim=!0,this.setState({ctrlFileOpts:t})}},{key:"handleSpecTreeInfCheckbox",value:function(e){var t=Object(L.a)({},this.state.ctrlFileOpts);this.state.ctrlFileOpts.speciesTreeInf?t.speciesTreeInf=!1:t.speciesTreeInf=!0,this.setState({ctrlFileOpts:t})}},{key:"handleDiploidCheckbox",value:function(e){var t=Object(L.a)({},this.state.ctrlFileOpts);this.state.ctrlFileOpts.diploid?t.diploid=!1:t.diploid=!0,this.setState({ctrlFileOpts:t})}},{key:"handleBurninSet",value:function(e){var t=Object(L.a)({},this.state.ctrlFileOpts);t.burnin=e.target.value,this.setState({ctrlFileOpts:t})}},{key:"handleSampleFreqSet",value:function(e){var t=Object(L.a)({},this.state.ctrlFileOpts);t.sampleFreq=e.target.value,this.setState({ctrlFileOpts:t})}},{key:"handleMcmcSamples",value:function(e){var t=Object(L.a)({},this.state.ctrlFileOpts);t.mcmcSamples=e.target.value,this.setState({ctrlFileOpts:t})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"mapfile-box"},r.a.createElement("h2",null,"Step 3:"),r.a.createElement("p",null,"Create a control file in bpp format. We will use the sequence data you uploaded to choose sensible defaults"),r.a.createElement(x.Columns,{gutters:!0,stackMaxWidth:700},r.a.createElement(x.Column,{size:22},r.a.createElement(_,{sequenceData:this.props.sequenceData,readFile:this.handleMapFileRead}),r.a.createElement(X,{mapData:this.state.mapData,ctrlFileOpts:this.state.ctrlFileOpts,handleSpecDelimCheckbox:this.handleSpecDelimCheckbox,handleSpecTreeInfCheckbox:this.handleSpecTreeInfCheckbox,handleDiploidCheckbox:this.handleDiploidCheckbox,handleBurninSet:this.handleBurninSet,handleSampleFreqSet:this.handleSampleFreqSet,handleMcmcSamples:this.handleMcmcSamples})),r.a.createElement(x.Column,{size:35},r.a.createElement(V,{sequenceData:this.props.sequenceData,mapData:this.state.mapData,seqFileName:this.props.seqFileName,mapFileName:this.state.mapFileName,ctrlFileOpts:this.state.ctrlFileOpts,speciesList:this.state.speciesList,numberSeqs:this.state.numberSeqs,nTree:this.state.nTree,priors:this.state.priors})))),r.a.createElement("div",null),r.a.createElement("div",{className:"quick-start"},r.a.createElement("p",null,"Quick start: If step 1 is complete a link will appear above to upload a map file. Upload the mapfile created in step 2 (or another mapfile conforming with the sequence data uploaded in step 1.")))}}]),t}(n.Component),te=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(o.a)(this,Object(u.a)(t).call(this))).state={seqFiletext:"",sequenceData:[],locusArray:[],locusCounts:[],seqFileName:""},e.readFile=e.readFile.bind(Object(m.a)(Object(m.a)(e))),e}return Object(p.a)(t,e),Object(c.a)(t,[{key:"readFile",value:function(e,t){var a,n=this;this.setState(function(){return{seqFiletext:e}}),null===(a=T(e)).error?(this.setState(function(){return{sequenceData:a.sequenceData}}),this.setState(function(){return{locusArray:I(n.state.sequenceData)}}),this.setState(function(){return{locusCounts:M(n.state.sequenceData)}}),this.setState(function(){return{seqFileName:t}})):(alert(a.error),this.setState(function(){return{sequenceData:[]}}),this.setState(function(){return{locusArray:[" "]}}),this.setState(function(){return{locusCounts:[]}}))}},{key:"render",value:function(){var e=this;return r.a.createElement(h.a,null,r.a.createElement("div",null,r.a.createElement("h1",null,"Minimalist bpp"),r.a.createElement("ul",{className:"header"},r.a.createElement("li",null,r.a.createElement(d.a,{to:"/"},"Upload Sequences")),r.a.createElement("li",null,r.a.createElement(d.a,{to:"/MapFile"},"Create Map File")),r.a.createElement("li",null,r.a.createElement(d.a,{to:"/CtrlFile"},"Create Control File"))),r.a.createElement("div",{className:"content"},r.a.createElement(f.a,{exact:!0,path:"/",render:function(t){return r.a.createElement(g,Object.assign({},t,{readFile:e.readFile,locusArray:e.state.locusArray,locusCounts:e.state.locusCounts}))}}),r.a.createElement(f.a,{path:"/MapFile",render:function(t){return r.a.createElement(D,Object.assign({},t,{sequenceData:e.state.sequenceData,seqFileName:e.state.seqFileName}))}}),r.a.createElement(f.a,{path:"/CtrlFile",render:function(t){return r.a.createElement(ee,Object.assign({},t,{sequenceData:e.state.sequenceData,seqFileName:e.state.seqFileName}))}}))))}}]),t}(n.Component);a(39);l.a.render(r.a.createElement(te,null),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.47ce0aa4.chunk.js.map